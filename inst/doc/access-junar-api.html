<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Frans van Dunné" />

<meta name="date" content="2016-03-28" />

<title>Access Open Data with the Junar API</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div class="fluid-row" id="header">


<h1 class="title">Access Open Data with the Junar API</h1>
<h4 class="author"><em>Frans van Dunné</em></h4>
<h4 class="date"><em>2016-03-28</em></h4>

</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The Junar API is the basis for a number of Open Data initiatives in Latin America and the USA. The <code>junr</code> package is a wrapper to make it easier to access data made public through the Junar API. Some examples of implementations are: <a href="http://data.cityofpasadena.net/home/">the City of Pasadena</a>, and <a href="http://data.sanjoseca.gov/home/">the City of San Jose</a>. Others are listed on the <a href="http://junar.com/">Junar website</a>.</p>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<p>As an example we will use the data from the <a href="http://datosabiertos.presidencia.go.cr/home">Costa Rican President’s Office</a>.The first step is to access the website offering the open data to identify the base URL and to obtain an API Key to get access to the Junar API that hosts the data. You will find both on the <a href="http://datosabiertos.presidencia.go.cr/developers/">developers page of the Open Data Costa Rica site</a>.</p>
<p>Below we use a test API Key so that all the examples will run. You may want to get your own API Key instead to run the examples below. Note that with Junar each URL has its own API key.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(junr)
base_url &lt;-<span class="st"> &quot;http://api.datosabiertos.presidencia.go.cr/api/v2/datastreams/&quot;</span>
api_key &lt;-<span class="st"> &quot;0bd55e858409eefabc629b28b2e7916361ef20ff&quot;</span> </code></pre></div>
<p>Now that we have the basic information for a connection we can quickly check what data is available behind this URL.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_index</span>(base_url, api_key)</code></pre></div>
<p>The <code>get_index</code>function returns the complete list of available data with all meta-data included as a data frame.</p>
<p>To get only a list of the global unique identifiers (GUID) of the data sets, you can use <code>list_guid</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list_guid</span>(base_url, api_key)</code></pre></div>
<pre><code>##  [1] &quot;PLANI-DEL-MINIS&quot;           &quot;DATOS-CORRE-AL-PAGO-DE&quot;   
##  [3] &quot;COMPR-PUBLI-DEL-MINIS&quot;     &quot;LICIT-ADJUD-POR-LAS-81483&quot;
##  [5] &quot;LICIT-ADJUD-POR-LOS-MINIS&quot; &quot;LICIT-ADJUD-POR-LAS-INSTI&quot;
##  [7] &quot;LICIT-ADJUD-DE-LAS-INSTI&quot;  &quot;DATOS-CORRE-AL-PAGO-32327&quot;
##  [9] &quot;DESCR-DE-ABREV-DE-LAS&quot;     &quot;EJECU-DE-PRESU-DE-50724&quot;  
## [11] &quot;EJECU-DE-PRESU-DE-INSTI&quot;   &quot;COMPR-PUBLI-DE-PRESI&quot;</code></pre>
<p>This has the benefit that a reference can be made to the GUID based on position number. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pres_list &lt;-<span class="kw">list_guid</span>(base_url, api_key)
pres_list[<span class="dv">3</span>]</code></pre></div>
<pre><code>## [1] &quot;COMPR-PUBLI-DEL-MINIS&quot;</code></pre>
<p>And the same numbers can be used based on the full title with <code>list_titles</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list_titles</span>(base_url, api_key)</code></pre></div>
<pre><code>##  [1] &quot;Ministerio de la Presidencia&quot;                                                    
##  [2] &quot;Datos correspondientes al pago de planilla de Presidencia&quot;                       
##  [3] &quot;Compras públicas del Ministerio de la Presidencia&quot;                               
##  [4] &quot;Licitaciones adjudicadas por las Instituciones Públicas según tipo de trámite&quot;   
##  [5] &quot;Licitaciones adjudicadas por los Ministerios&quot;                                    
##  [6] &quot;Licitaciones adjudicadas por las Instituciones Públicas según año&quot;               
##  [7] &quot;Licitaciones Adjudicadas de las Instituciones Públicas para el período 2014-2015&quot;
##  [8] &quot;Datos correspondientes al pago de planilla del Ministerio&quot;                       
##  [9] &quot;Descripción de abreviaturas de las ejecuciones &quot;                                 
## [10] &quot;Ejecución de presupuesto de Instituciones para el 2014&quot;                          
## [11] &quot;Ejecución de presupuesto de Instituciones para el 2015&quot;                          
## [12] &quot;Compras públicas de Presidencia&quot;</code></pre>
<p>Both <code>list_guid</code> and <code>list_titles</code> where set up for convenience only because the results tend to fit in the console window making it easier to read.</p>
<p>Obviously, if you have the GUID of the data that interest you, you can use this directly to make a call to read all the data. For example, to view all public purchasing of the presidential office in Costa Rica:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_guid &lt;-<span class="st"> &quot;COMPR-PUBLI-DEL-MINIS&quot;</span>
purchasing_data &lt;-<span class="st"> </span><span class="kw">get_data</span>(base_url, api_key, data_guid)</code></pre></div>
<p>With <code>View(purchasing_data)</code> you can check whether the data have been downloaded correctly, and have a quick visual check on the mode of the data (see below to convert currency data from text to numeric).</p>
<div id="determine-data-dimensions" class="section level3">
<h3>Determine data dimensions</h3>
<p>On data platforms that run Junar, many data sets are just tables of data that has already been analyzed and summarized. It is not immediately obvious which sets contain many data points, and which sets contain only a few rows.</p>
<p>The function <code>get_dimensions</code> will download all data sets offered through the base URL and determine how many rows and columns are available in each one. It is useful to make a quick assessment of the data available. However, please note that it may take a while before the function finishes, especially if there are many GUID’s.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_dimensions</span>(base_url, api_key)</code></pre></div>
<pre><code>##                         GUID   NROW NCOL    DIM
## 2            PLANI-DEL-MINIS   5561    8  44488
## 21    DATOS-CORRE-AL-PAGO-DE   2472   10  24720
## 3      COMPR-PUBLI-DEL-MINIS    324    4   1296
## 4  LICIT-ADJUD-POR-LAS-81483      7    2     14
## 5  LICIT-ADJUD-POR-LOS-MINIS     10    2     20
## 6  LICIT-ADJUD-POR-LAS-INSTI      3    2      6
## 7   LICIT-ADJUD-DE-LAS-INSTI 103471    7 724297
## 8  DATOS-CORRE-AL-PAGO-32327   5561   10  55610
## 9      DESCR-DE-ABREV-DE-LAS     27    4    108
## 10   EJECU-DE-PRESU-DE-50724   9249   40 369960
## 11   EJECU-DE-PRESU-DE-INSTI   8867   39 345813
## 12      COMPR-PUBLI-DE-PRESI    427    4   1708</code></pre>
</div>
<div id="clean-up-currency-data" class="section level3">
<h3>Clean up currency data</h3>
<p>In the example data above, and possibly in more Junar implementations, we need to clean up any data related to currency values. In our case we need to found all currency symbols (Costa Rica Colon) and all the comma’s separating thousands. As they stand these values are text strings, and cannot be converted directly to numeric without removing the symbols and commas.</p>
<p>There are two utilities to help cleaning the currency data: <code>clean_currency</code> and <code>get_currency_symbol</code>. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">currency_data &lt;-<span class="st"> </span><span class="kw">get_data</span>(base_url, api_key, <span class="st">&quot;LICIT-ADJUD-POR-LOS-MINIS&quot;</span>)
currency_data$<span class="st">`</span><span class="dt">Monto Adjudicado</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">clean_currency</span>(currency_data$<span class="st">`</span><span class="dt">Monto Adjudicado</span><span class="st">`</span>)  </code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
